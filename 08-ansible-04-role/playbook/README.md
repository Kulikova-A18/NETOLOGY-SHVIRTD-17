# playbook

playbook — это файл, который используется в системах управления конфигурацией, таких как Ansible, для автоматизации процессов установки и настройки программного обеспечения. Playbook описывает шаги, которые необходимо выполнить для достижения определенной цели, например, установки и настройки ClickHouse, Vector и LightHouse.

## Описание

playbook использует следующие роли:

1. clickhouse - Это колоночная СУБД, оптимизированная для аналитических запросов в реальном времени. Документацию по ролям можно посмотреть в соответствующем репозитории: https://github.com/AlexeySetevoi/ansible-clickhouse
2. vector-role - Это инструмент для обработки и передачи данных в реальном времени. Документацию по ролям можно посмотреть в соответствующем репозитории: https://github.com/Kulikova-A18/vector-role
3. lighthouse-role - Это инструмент для мониторинга и анализа производительности веб-приложений. Документацию по ролям можно посмотреть в соответствующем репозитории: https://github.com/Kulikova-A18/lighthouse-role

## Запуск playbook

Для запуска плейбука необходимо выполнить следующие шаги:

1. Установка необходимых ролей:

* Перейдите в корневую директорию вашего playbook.
* Выполните команду:

```
ansible-galaxy install -r requirements.yml -p roles
```

* Эта команда загрузит все необходимые роли, указанные в файле requirements.yml, и разместит их в каталоге roles.

2. Настройка инвентарного файла:

* Откройте и заполните инвентарный файл в соответствии с описанием.
* Убедитесь, что вы указали все целевые хосты и их параметры.

3. Запуск плейбука:

* Выполните следующую команду для запуска playbook:

```
ansible-playbook -i inventory/prod.yml site.yml
```

* Убедитесь, что вы находитесь в той же директории, где расположен файл site.yml.

## Порядок выполнения playbook

| Порядок выполнения | Описание                                                                                     |
|--------------------|----------------------------------------------------------------------------------------------|
| Первый плей        | Устанавливает роль для ClickHouse на всех хостах, указанных в группе clickhouse в инвентарном файле. |
| Второй плей        | Устанавливает роль для Vector на всех хостах, указанных в группе vector в инвентарном файле.         |
| Третий плей        | Устанавливает роли для Nginx и Lighthouse на всех хостах, указанных в группе lighthouse в инвентарном файле. |

## Инвентарный (inventory) файл

Перед выполнением playbook необходимо указать хосты в соответствующие группы в инвентарном файле. 

Инвентарный файл содержит три группы хостов:

1. clickhouse
2. vector
3. lighthouse

На хостах, указанных в каждой группе, будет выполнена роль, соответствующая имени группы.
