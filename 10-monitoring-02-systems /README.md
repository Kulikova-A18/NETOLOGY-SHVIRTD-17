# Домашнее задание к занятию "13.Системы мониторинга"

| Метрика                     | Описание                                                                 | Причина важности                                                                                 |
|----------------------------------|-----------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|
| CPU Utilization              | Использование ЦПУ                                                         | Ключевая метрика для оценки нагрузки от вычислений, которые могут привести к перегрузке системы.    |
| RAM Utilization              | Использование оперативной памяти                                          | Важно для определения, не исчерпана ли память, что может снизить производительность или вызвать сбой|
| Disk Utilization             | Использование дискового пространства                                      | Помогает предотвратить переполнение диска и потерю данных                                         |
| Network Throughput           | Объем сетевого трафика                                                  | Позволяет убедиться, что сеть не является узким местом при взаимодействии по протоколу HTTP        |
| Error Logs                   | Логи ошибок и исключений                                                 | Позволяет выявлять и решать проблемы в системе, улучшая качество обслуживания                      |
| Availability Metrics         | Метрики доступности платформы                                           | Важны для обеспечения надежной работы и своевременного уведомления о сбоях                         |

Для того чтобы менеджер продукта лучше понимал метрики и качество обслуживания, можно предложить следующие понятия:

| Термин                  | Описание                                                                                     |
|-----------------------------|--------------------------------------------------------------------------------------------------|
| RAM (Оперативная память)| Объем оперативной памяти, используемой сервером или приложением                                |
| Inodes                  | Структуры данных в файловой системе, отслеживающие информацию о файлах и каталогах            |
| CPU Load Average        | Средняя нагрузка на процессор системы, показывающая, насколько активно используется ЦПУ       |
| SLA (Service Level Agreement) | Соглашение об уровне обслуживания, которое определяет ожидаемое качество услуг для клиентов |

В условиях отсутствия финансирования на систему сбора логов можно предложить следующее решение Использовать бесплатные или открытые инструменты для сбора и анализа логов, такие как ELK Stack (Elasticsearch, Logstash, Kibana) или Fluentd и Grafana

| Формула SLA                                                                                     |
|------------------------------------------------------------------------------------------------------|
| SLA = (summ2xxrequests + summ3xxrequests + summ1xxrequests) / summallrequests             |


| Тип системы мониторинга | Плюсы                                                                                                            | Минусы                                                                                                           |
|-----------------------------|---------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|
| Pull системы мониторинга | - Сниженная нагрузка на целевые системы агенты опрашивают целевые системы по запросу, что снижает нагрузку      | - Задержка в обновлении данных опрос по расписанию может снизить способность обнаружения проблем в реальном времени|
|                             | - Более простая настройка и установка агенты легко развертываются на серверах без дополнительных настроек       | - Потеря данных если агент не может опросить систему, это может привести к потере данных мониторинга             |
|                             | - Прозрачность для целевых систем системы могут быть неосведомлены о наличии мониторинга и агентов              |                                                                                                                     |
| Push системы мониторинга | - Реальное время позволяют отправлять данные в реальном времени, что способствует мгновенному реагированию    | - Высокая нагрузка на целевые системы может возникнуть проблема с нагрузкой при отправке большого объема данных    |
|                             | - Легкость настройки центрального сервера централизованный сервер проще настроить для обработки данных         | - Сложность настройки агентов установка агентов может быть более сложной и требовать больше ресурсов              |
|                             | - Уведомления в режиме реального времени возможность отправки уведомлений на основе данных мониторинга         | - Безопасность и приватность требуется доступ для приема данных, что может повысить риски безопасности            |

| Система мониторинга    | Модель        |
|----------------------------|-------------------|
| Prometheus                 | Pull              |
| TICK                       | Push              |
| Zabbix                     | Pull, Push        |
| VictoriaMetrics            | Push              |
| Nagios                     | Pull              |

Zabbix можно отнести к гибридной модели, так как он поддерживает как push, так и pull механизмы

7. репозитарий influxdata - sandbox https://github.com/influxdata/sandbox/tree/master

![image](https://github.com/user-attachments/assets/59f59be5-adc2-4b35-9d10-d17e82e0ed80)


8. Перейдите в веб-интерфейс Chronograf (http://localhost:8888) и откройте вкладку Data explorer.
        
    - Нажмите на кнопку Add a query
    - Изучите вывод интерфейса и выберите БД telegraf.autogen
    - В `measurments` выберите cpu->host->telegraf-getting-started, а в `fields` выберите usage_system. Внизу появится график утилизации cpu.
    - Вверху вы можете увидеть запрос, аналогичный SQL-синтаксису. Поэкспериментируйте с запросом, попробуйте изменить группировку и интервал наблюдений.

![image](https://github.com/user-attachments/assets/66edcc9c-87ac-4760-91fd-93dd6f07dcd8)

9. Изучите список [telegraf inputs](https://github.com/influxdata/telegraf/tree/master/plugins/inputs). 
Добавьте в конфигурацию telegraf следующий плагин - [docker](https://github.com/influxdata/telegraf/tree/master/plugins/inputs/docker):
```
[[inputs.docker]]
  endpoint = "unix:///var/run/docker.sock"
```

Дополнительно вам может потребоваться донастройка контейнера telegraf в `docker-compose.yml` дополнительного volume и 
режима privileged:
```
  telegraf:
    image telegraf:1.4.0
    privileged true
    volumes:
      - ./etc/telegraf.conf:/etc/telegraf/telegraf.conf:Z
      - /var/run/docker.sock:/var/run/docker.sock:Z
    links:
      - influxdb
    ports:
      - "8092:8092/udp"
      - "8094:8094"
      - "8125:8125/udp"
```

После настройке перезапустите telegraf, обновите веб интерфейс и приведите скриншотом список `measurments` в 
веб-интерфейсе базы telegraf.autogen . Там должны появиться метрики, связанные с docker.

![image](https://github.com/user-attachments/assets/adae34e2-7ce4-48d6-8c69-3a83960b1bc3)
