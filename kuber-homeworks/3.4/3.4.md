# Домашнее задание к занятию «Обновление приложений»

### Цель задания

Выбрать и настроить стратегию обновления приложения.

### Чеклист готовности к домашнему заданию

1. Кластер K8s.

### Инструменты и дополнительные материалы, которые пригодятся для выполнения задания

1. [Документация Updating a Deployment](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#updating-a-deployment).
2. [Статья про стратегии обновлений](https://habr.com/ru/companies/flant/articles/471620/).

-----

### Задание 1. Выбрать стратегию обновления приложения и описать ваш выбор

1. Имеется приложение, состоящее из нескольких реплик, которое требуется обновить.
2. Ресурсы, выделенные для приложения, ограничены, и нет возможности их увеличить.
3. Запас по ресурсам в менее загруженный момент времени составляет 20%.
4. Обновление мажорное, новые версии приложения не умеют работать со старыми.
5. Вам нужно объяснить свой выбор стратегии обновления приложения.

### Задание 1. Решение

На основании вышеуказанных условий, я выбираю стратегию recreate для обновления приложения. 

1. Поскольку новая версия приложения не поддерживает работу со старыми версиями, стратегия "recreate" является единственным приемлемым вариантом. Другие методы, такие как "rolling update", невозможны из-за несовместимости версий.
2. Так как имеются условия ограниченных ресурсов важно выбрать стратегию, которая позволит максимально эффективно использовать доступные мощности.  "recreate" подразумевает полное удаление старых подов перед развертыванием новых, что позволяет избежать проблем с нехваткой ресурсов в процессе обновления.
3. "recreate" проста в реализации и управлении, т.к. требует меньше временных затрат на планирование и координацию, так как все старые поды будут удалены до развертывания новых, что снижает вероятность ошибок.
4. хоть и данный метод приведет к недоступности приложения на период обновления, это может быть запланировано на время с минимальной нагрузкой
5.  "recreate" обеспечивает предсказуемость процесса обновления, т.к. точно знаем, когда старые поды будут удалены и новые будут развернуты, что позволяет лучше контролировать процесс и минимизировать риски.

### Задание 2. Обновить приложение

1. Создать deployment приложения с контейнерами nginx и multitool. Версию nginx взять 1.19. Количество реплик — 5.
2. Обновить версию nginx в приложении до версии 1.20, сократив время обновления до минимума. Приложение должно быть доступно.
3. Попытаться обновить nginx до версии 1.28, приложение должно оставаться доступным.
4. Откатиться после неудачного обновления.

### Задание 2. Решение

